/**
 * QUANTUM Morning Intelligence Report v1.0
 * 
 * Sent daily at 07:30 Israel time (after listings scan at 07:00)
 * 
 * Report contents:
 * 1. Top 3 hottest opportunities (by IAI)
 * 2. Top 3 stressed sellers (by SSI)
 * 3. Price drops in last 24h (new listings with price_changes > 0)
 * 4. Committee approvals in last 7 days
 */

const pool = require('../db/pool');
const { logger } = require('./logger');
const { sendEmail, NOTIFICATION_EMAILS } = require('./notificationService');

const DASHBOARD_URL = 'https://pinuy-binuy-analyzer-production.up.railway.app/api/dashboard';

// ─── COLORS ──────────────────────────────────────────────────
const C = {
  bg: '#0a0e1a',
  card: '#0d1220',
  border: '#1a2035',
  accent: '#06d6a0',
  gold: '#ffc233',
  red: '#ff4d6a',
  blue: '#3b82f6',
  purple: '#9f7aea',
  text: '#e2e8f0',
  muted: '#64748b'
};

// ─── DATA FETCHERS ────────────────────────────────────────────

async function getTopOpportunities() {
  try {
    const result = await pool.query(`
      SELECT 
        c.name, c.city, c.iai_score, c.status, c.developer,
        c.signature_percent, c.plan_stage, c.actual_premium,
        c.theoretical_premium_max, c.address,
        COALESCE(c.slug, c.id::text) as slug
      FROM complexes c
      WHERE c.iai_score IS NOT NULL AND c.iai_score >= 60
      ORDER BY c.iai_score DESC
      LIMIT 5
    `);
    return result.rows;
  } catch (e) {
    logger.error('[MorningReport] getTopOpportunities failed:', e.message);
    return [];
  }
}

async function getTopStressedSellers() {
  try {
    const result = await pool.query(`
      SELECT 
        l.id, l.address, l.city, l.asking_price, l.area_sqm, l.rooms,
        l.ssi_score, l.days_on_market, l.price_changes, 
        l.total_price_drop_percent, l.original_price,
        l.has_urgent_keywords, l.is_foreclosure, l.is_inheritance,
        l.url, l.ssi_category, l.strategy, l.potential_discount,
        c.name as complex_name, c.iai_score, c.city as complex_city,
        c.plan_stage, c.developer
      FROM listings l
      LEFT JOIN complexes c ON l.complex_id = c.id
      WHERE l.ssi_score >= 30 AND l.deal_status NOT IN ('סגור', 'נפל')
      ORDER BY l.ssi_score DESC
      LIMIT 5
    `);
    return result.rows;
  } catch (e) {
    logger.error('[MorningReport] getTopStressedSellers failed:', e.message);
    return [];
  }
}

async function getPriceDrops24h() {
  try {
    const result = await pool.query(`
      SELECT 
        l.id, l.address, l.city, l.asking_price, l.area_sqm, l.rooms,
        l.price_changes, l.total_price_drop_percent, l.original_price,
        l.ssi_score, l.days_on_market, l.url,
        c.name as complex_name, c.iai_score
      FROM listings l
      LEFT JOIN complexes c ON l.complex_id = c.id
      WHERE 
        l.price_changes > 0 
        AND l.last_seen >= NOW() - INTERVAL '24 hours'
        AND l.total_price_drop_percent >= 5
      ORDER BY l.total_price_drop_percent DESC
      LIMIT 5
    `);
    return result.rows;
  } catch (e) {
    logger.error('[MorningReport] getPriceDrops24h failed:', e.message);
    return [];
  }
}

async function getRecentCommitteeApprovals() {
  try {
    const result = await pool.query(`
      SELECT 
        a.id, a.complex_id, a.title, a.meeting_date, a.decision, 
        a.decision_type, a.source_url, a.source_confidence,
        c.name as complex_name, c.city, c.iai_score,
        c.actual_premium, c.theoretical_premium_max
      FROM committee_approvals a
      LEFT JOIN complexes c ON a.complex_id = c.id
      WHERE a.meeting_date >= NOW() - INTERVAL '7 days'
        AND a.decision_type IN ('approval', 'advancement', 'declaration')
      ORDER BY a.meeting_date DESC
      LIMIT 5
    `);
    return result.rows;
  } catch (e) {
    // Table might not exist, or no recent approvals
    logger.warn('[MorningReport] getRecentCommitteeApprovals:', e.message);
    return [];
  }
}

async function getSummaryStats() {
  try {
    const result = await pool.query(`
      SELECT 
        COUNT(*) FILTER (WHERE iai_score >= 30) as opportunities,
        COUNT(*) FILTER (WHERE iai_score >= 70) as excellent,
        COUNT(*) as total
      FROM complexes
    `);
    const listings = await pool.query(`
      SELECT 
        COUNT(*) FILTER (WHERE ssi_score >= 30) as stressed,
        COUNT(*) FILTER (WHERE ssi_score >= 60) as high_stress,
        COUNT(*) FILTER (WHERE last_seen >= NOW() - INTERVAL '24 hours') as new_today
      FROM listings
      WHERE deal_status NOT IN ('סגור', 'נפל')
    `);
    return {
      ...result.rows[0],
      ...listings.rows[0]
    };
  } catch (e) {
    logger.error('[MorningReport] getSummaryStats failed:', e.message);
    return {};
  }
}

// ─── HTML BUILDER ─────────────────────────────────────────────

function formatPrice(p) {
  if (!p) return '-';
  const n = parseFloat(p);
  if (n >= 1000000) return `₪${(n / 1000000).toFixed(2)}מ'`;
  if (n >= 1000) return `₪${Math.round(n / 1000)}K`;
  return `₪${Math.round(n)}`;
}

function iaiColor(score) {
  if (score >= 70) return C.accent;
  if (score >= 50) return C.gold;
  return C.red;
}

function ssiColor(score) {
  if (score >= 60) return C.red;
  if (score >= 30) return C.gold;
  return C.accent;
}

function iaiLabel(score) {
  if (score >= 70) return 'מצוין';
  if (score >= 50) return 'טוב';
  if (score >= 30) return 'ממוצע';
  return 'חלש';
}

function planStageHebrew(stage) {
  const map = {
    'declared': 'הוכרז', 'approved': 'אושרה', 'deposit': 'הפקדה',
    'construction': 'בנייה', 'planning': 'תכנון', 'initial': 'ראשוני'
  };
  return map[stage] || stage || '-';
}

function buildOpportunityCard(opp, idx) {
  const color = iaiColor(opp.iai_score);
  const premium = opp.actual_premium ? `${parseFloat(opp.actual_premium).toFixed(0)}%` : '-';
  const sigPct = opp.signature_percent ? `${opp.signature_percent}%` : '-';
  
  return `
    <div style="background:${C.card};border:1px solid ${C.border};border-radius:10px;padding:18px;margin-bottom:14px;direction:rtl;position:relative;border-right:4px solid ${color};">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;">
        <div>
          <span style="font-size:11px;color:${C.muted};font-weight:500;">#${idx + 1} הזדמנות</span>
          <h3 style="margin:4px 0 0;font-size:16px;font-weight:700;color:${C.text};">${opp.name}</h3>
          <span style="font-size:13px;color:${C.muted};">${opp.city}${opp.address ? ' | ' + opp.address.split(',')[0] : ''}</span>
        </div>
        <div style="text-align:center;background:${color}20;border:1px solid ${color};border-radius:8px;padding:8px 14px;">
          <div style="font-size:22px;font-weight:900;color:${color};">${opp.iai_score}</div>
          <div style="font-size:10px;color:${color};font-weight:600;">IAI | ${iaiLabel(opp.iai_score)}</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        <span style="font-size:12px;background:${C.bg};border:1px solid ${C.border};border-radius:6px;padding:4px 10px;color:${C.muted};">
          📋 ${planStageHebrew(opp.plan_stage)}
        </span>
        <span style="font-size:12px;background:${C.bg};border:1px solid ${C.border};border-radius:6px;padding:4px 10px;color:${C.muted};">
          ✍️ חתימות: ${sigPct}
        </span>
        <span style="font-size:12px;background:${C.bg};border:1px solid ${C.border};border-radius:6px;padding:4px 10px;color:${C.muted};">
          📈 פרמיה: ${premium}
        </span>
        ${opp.developer ? `<span style="font-size:12px;background:${C.bg};border:1px solid ${C.border};border-radius:6px;padding:4px 10px;color:${C.muted};">🏗 ${opp.developer.split(' ').slice(0,3).join(' ')}</span>` : ''}
      </div>
    </div>
  `;
}

function buildSellerCard(seller, idx) {
  const color = ssiColor(seller.ssi_score);
  const drop = seller.total_price_drop_percent ? `${parseFloat(seller.total_price_drop_percent).toFixed(1)}%` : '0%';
  
  return `
    <div style="background:${C.card};border:1px solid ${C.border};border-radius:10px;padding:18px;margin-bottom:14px;direction:rtl;border-right:4px solid ${color};">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;">
        <div>
          <span style="font-size:11px;color:${C.muted};">#${idx + 1} מוכר לחוץ</span>
          <h3 style="margin:4px 0 0;font-size:16px;font-weight:700;color:${C.text};">${seller.address || seller.city || '-'}</h3>
          <span style="font-size:13px;color:${C.muted};">${seller.complex_name || seller.city} ${seller.rooms ? '| ' + seller.rooms + ' חד\'' : ''}</span>
        </div>
        <div style="text-align:center;background:${color}20;border:1px solid ${color};border-radius:8px;padding:8px 14px;">
          <div style="font-size:22px;font-weight:900;color:${color};">${seller.ssi_score}</div>
          <div style="font-size:10px;color:${color};font-weight:600;">SSI | לחץ</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px;">
        <span style="font-size:12px;background:${C.bg};border:1px solid ${C.border};border-radius:6px;padding:4px 10px;color:${C.muted};">
          💰 ${formatPrice(seller.asking_price)}
        </span>
        <span style="font-size:12px;background:#ff4d6a20;border:1px solid #ff4d6a50;border-radius:6px;padding:4px 10px;color:#ff4d6a;">
          ▼ ירד ${drop}
        </span>
        <span style="font-size:12px;background:${C.bg};border:1px solid ${C.border};border-radius:6px;padding:4px 10px;color:${C.muted};">
          📅 ${seller.days_on_market} ימים שוק
        </span>
        <span style="font-size:12px;background:${C.bg};border:1px solid ${C.border};border-radius:6px;padding:4px 10px;color:${C.muted};">
          🔄 ${seller.price_changes || 0} שינויי מחיר
        </span>
        ${seller.is_foreclosure ? '<span style="font-size:12px;background:#ff4d6a20;border:1px solid #ff4d6a;border-radius:6px;padding:4px 10px;color:#ff4d6a;">⚖️ כינוס</span>' : ''}
        ${seller.is_inheritance ? '<span style="font-size:12px;background:#9f7aea20;border:1px solid #9f7aea;border-radius:6px;padding:4px 10px;color:#9f7aea;">📜 ירושה</span>' : ''}
      </div>
      ${seller.strategy ? `<div style="font-size:12px;color:${C.muted};font-style:italic;">💡 ${seller.strategy} | פוטנציאל: ${seller.potential_discount || '-'}</div>` : ''}
      ${seller.url ? `<div style="margin-top:8px;"><a href="${seller.url}" style="color:${C.accent};font-size:12px;text-decoration:none;">🔗 צפה ביד2 →</a></div>` : ''}
    </div>
  `;
}

function buildPriceDropCard(drop, idx) {
  const pct = parseFloat(drop.total_price_drop_percent || 0).toFixed(1);
  const saved = parseFloat(drop.original_price || 0) - parseFloat(drop.asking_price || 0);
  
  return `
    <div style="background:${C.card};border:1px solid ${C.border};border-radius:10px;padding:15px;margin-bottom:10px;direction:rtl;border-right:4px solid #ff4d6a;">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <span style="font-size:13px;font-weight:600;color:${C.text};">${drop.address || drop.city}</span>
          <div style="font-size:12px;color:${C.muted};">${drop.complex_name || drop.city} ${drop.rooms ? '| ' + drop.rooms + ' חד\'' : ''}</div>
        </div>
        <div style="text-align:center;">
          <div style="font-size:20px;font-weight:800;color:#ff4d6a;">▼${pct}%</div>
          <div style="font-size:11px;color:${C.muted};">${formatPrice(drop.original_price)} → ${formatPrice(drop.asking_price)}</div>
        </div>
      </div>
      <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap;">
        <span style="font-size:11px;color:#ff4d6a;">💸 חיסכון: ${formatPrice(saved.toString())}</span>
        <span style="font-size:11px;color:${C.muted};">· ${drop.price_changes} שינויים · ${drop.days_on_market} ימים</span>
        ${drop.iai_score ? `<span style="font-size:11px;color:${iaiColor(drop.iai_score)};">IAI: ${drop.iai_score}</span>` : ''}
      </div>
      ${drop.url ? `<a href="${drop.url}" style="display:block;margin-top:6px;color:${C.accent};font-size:11px;text-decoration:none;">🔗 יד2 →</a>` : ''}
    </div>
  `;
}

function buildCommitteeCard(item, idx) {
  return `
    <div style="background:${C.card};border:1px solid ${C.border};border-radius:10px;padding:15px;margin-bottom:10px;direction:rtl;border-right:4px solid ${C.accent};">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <span style="font-size:13px;font-weight:600;color:${C.text};">${item.complex_name || '-'}</span>
          <div style="font-size:12px;color:${C.muted};">${item.city || ''} | ${new Date(item.meeting_date).toLocaleDateString('he-IL')}</div>
          <div style="font-size:12px;color:${C.accent};margin-top:4px;">${item.title || item.decision || ''}</div>
        </div>
        ${item.iai_score ? `<span style="background:${iaiColor(item.iai_score)}20;border:1px solid ${iaiColor(item.iai_score)};border-radius:6px;padding:4px 10px;font-size:12px;color:${iaiColor(item.iai_score)};">IAI ${item.iai_score}</span>` : ''}
      </div>
    </div>
  `;
}

// ─── MAIN REPORT BUILDER ──────────────────────────────────────

function buildReportHTML(data) {
  const { opportunities, sellers, priceDrops, committees, stats, date } = data;
  
  const hebrewDate = new Date().toLocaleDateString('he-IL', {
    weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
    timeZone: 'Asia/Jerusalem'
  });

  const opportunityCards = opportunities.slice(0, 3).map((o, i) => buildOpportunityCard(o, i)).join('');
  const sellerCards = sellers.slice(0, 3).map((s, i) => buildSellerCard(s, i)).join('');
  const dropCards = priceDrops.slice(0, 5).map((d, i) => buildPriceDropCard(d, i)).join('');
  const committeeCards = committees.slice(0, 3).map((c, i) => buildCommitteeCard(c, i)).join('');

  return `
<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>QUANTUM - דוח בוקר</title>
</head>
<body style="margin:0;padding:0;background:#060b15;font-family:'Segoe UI',Arial,sans-serif;">

<div style="max-width:680px;margin:0 auto;padding:20px;">

  <!-- HEADER -->
  <div style="background:linear-gradient(135deg,#0a0e1a 0%,#0d1220 100%);border:1px solid #1a2035;border-radius:14px;padding:30px;margin-bottom:20px;text-align:center;">
    <div style="font-size:28px;font-weight:900;letter-spacing:3px;color:#06d6a0;margin-bottom:6px;">QUANTUM</div>
    <div style="font-size:14px;color:#64748b;">דוח מודיעין בוקר | ${hebrewDate}</div>
    
    <!-- KPI STRIP -->
    <div style="display:flex;gap:12px;margin-top:20px;justify-content:center;">
      <div style="background:#060b15;border:1px solid #1a2035;border-radius:8px;padding:12px 18px;flex:1;">
        <div style="font-size:22px;font-weight:800;color:#06d6a0;">${stats.opportunities || 0}</div>
        <div style="font-size:11px;color:#64748b;">הזדמנויות</div>
      </div>
      <div style="background:#060b15;border:1px solid #1a2035;border-radius:8px;padding:12px 18px;flex:1;">
        <div style="font-size:22px;font-weight:800;color:#ff4d6a;">${stats.stressed || 0}</div>
        <div style="font-size:11px;color:#64748b;">מוכרים לחוצים</div>
      </div>
      <div style="background:#060b15;border:1px solid #1a2035;border-radius:8px;padding:12px 18px;flex:1;">
        <div style="font-size:22px;font-weight:800;color:#ffc233;">${priceDrops.length}</div>
        <div style="font-size:11px;color:#64748b;">ירידות מחיר 24ש'</div>
      </div>
      <div style="background:#060b15;border:1px solid #1a2035;border-radius:8px;padding:12px 18px;flex:1;">
        <div style="font-size:22px;font-weight:800;color:#3b82f6;">${committees.length}</div>
        <div style="font-size:11px;color:#64748b;">ועדות השבוע</div>
      </div>
    </div>
  </div>

  <!-- TOP OPPORTUNITIES -->
  ${opportunities.length > 0 ? `
  <div style="margin-bottom:20px;">
    <h2 style="color:#06d6a0;font-size:16px;font-weight:700;margin:0 0 14px;padding-bottom:8px;border-bottom:1px solid #1a2035;direction:rtl;">
      ⭐ Top הזדמנויות
    </h2>
    ${opportunityCards}
  </div>
  ` : ''}

  <!-- STRESSED SELLERS -->
  ${sellers.length > 0 ? `
  <div style="margin-bottom:20px;">
    <h2 style="color:#ff4d6a;font-size:16px;font-weight:700;margin:0 0 14px;padding-bottom:8px;border-bottom:1px solid #1a2035;direction:rtl;">
      🔥 מוכרים לחוצים - לטפל היום
    </h2>
    ${sellerCards}
  </div>
  ` : ''}

  <!-- PRICE DROPS -->
  ${priceDrops.length > 0 ? `
  <div style="margin-bottom:20px;">
    <h2 style="color:#ffc233;font-size:16px;font-weight:700;margin:0 0 14px;padding-bottom:8px;border-bottom:1px solid #1a2035;direction:rtl;">
      📉 ירידות מחיר ב-24 שעות האחרונות
    </h2>
    ${dropCards}
  </div>
  ` : ''}

  <!-- COMMITTEE APPROVALS -->
  ${committees.length > 0 ? `
  <div style="margin-bottom:20px;">
    <h2 style="color:#3b82f6;font-size:16px;font-weight:700;margin:0 0 14px;padding-bottom:8px;border-bottom:1px solid #1a2035;direction:rtl;">
      🏛️ אישורי ועדה - השבוע
    </h2>
    ${committeeCards}
  </div>
  ` : ''}

  <!-- FOOTER -->
  <div style="background:#0d1220;border:1px solid #1a2035;border-radius:10px;padding:16px;text-align:center;margin-top:10px;">
    <div style="font-size:12px;color:#64748b;margin-bottom:10px;">QUANTUM Real Estate Intelligence</div>
    <a href="${DASHBOARD_URL}" style="display:inline-block;background:#06d6a0;color:#060b15;font-weight:700;font-size:13px;padding:10px 24px;border-radius:8px;text-decoration:none;">
      פתח דאשבורד QUANTUM →
    </a>
  </div>

</div>
</body>
</html>
  `.trim();
}

// ─── MAIN SEND FUNCTION ───────────────────────────────────────

async function sendMorningReport() {
  logger.info('[MorningReport] Starting morning report generation...');
  
  try {
    const [opportunities, sellers, priceDrops, committees, stats] = await Promise.all([
      getTopOpportunities(),
      getTopStressedSellers(),
      getPriceDrops24h(),
      getRecentCommitteeApprovals(),
      getSummaryStats()
    ]);

    logger.info(`[MorningReport] Data collected: ${opportunities.length} opp, ${sellers.length} sellers, ${priceDrops.length} drops, ${committees.length} committees`);

    const html = buildReportHTML({ opportunities, sellers, priceDrops, committees, stats, date: new Date() });

    const today = new Date().toLocaleDateString('he-IL', { 
      weekday: 'long', day: 'numeric', month: 'long', 
      timeZone: 'Asia/Jerusalem' 
    });
    const subject = `🌅 QUANTUM Morning Intel | ${today} | ${opportunities.length} הזדמנויות | ${sellers.length} לחוצים`;

    const results = [];
    for (const email of NOTIFICATION_EMAILS) {
      try {
        const result = await sendEmail(email, subject, html);
        results.push({ email, ...result });
        logger.info(`[MorningReport] Sent to ${email}:`, result);
      } catch (e) {
        logger.error(`[MorningReport] Failed to send to ${email}:`, e.message);
        results.push({ email, sent: false, error: e.message });
      }
    }

    return {
      success: true,
      sent_to: results,
      stats: {
        opportunities: opportunities.length,
        stressed_sellers: sellers.length,
        price_drops: priceDrops.length,
        committees: committees.length
      },
      generated_at: new Date().toISOString()
    };

  } catch (e) {
    logger.error('[MorningReport] Fatal error:', e.message, e.stack);
    return { success: false, error: e.message };
  }
}

module.exports = { sendMorningReport };
